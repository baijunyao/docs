(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{191:function(t,s,a){"use strict";a.r(s);var e=a(0),r=Object(e.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("p",[t._v("想在线实验可以使用"),a("a",{attrs:{href:"https://cloud.tencent.com/developer/labs/lab/10433",target:"_blank",rel:"noopener noreferrer"}},[t._v("腾讯云开发者实验室"),a("OutboundLink")],1),t._v("；"),a("br"),t._v("\nelasticsearch 需要 java8 以上；"),a("br"),t._v("\n这里安装最新版的 java10 ；"),a("br"),t._v("\n下载 jdk")]),t._v(" "),t._m(0),a("p",[t._v("因为版本会一直升级；"),a("br"),t._v("\n如果执行上面这段代码返回了 ERROR 404: Not Found ；"),a("br"),t._v("\n那说明有新版本了；"),a("br"),t._v("\n那就自己去官网复制最新的下载链接；"),a("br"),t._v(" "),a("a",{attrs:{href:"http://www.oracle.com/technetwork/java/javase/downloads/jdk10-downloads-4416644.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://www.oracle.com/technetwork/java/javase/downloads/jdk10-downloads-4416644.html"),a("OutboundLink")],1),t._v(" ;"),a("br"),t._v(" "),a("img",{attrs:{src:"/uploads/article/20180603/5b13f876ad730.jpg",alt:""}}),a("br"),t._v("\n选中 Accept License Agreement 然后在 jdk-10.0.1_linux-x64_bin.rpm 上右键复制链接地址；"),a("br"),t._v("\n替换上面命令中的下载链接；")]),t._v(" "),a("p",[t._v("安装 jdk 注意文件名要跟链接中的保持一直；")]),t._v(" "),t._m(1),a("p",[t._v("能查看到版本号则表示安装成功；")]),t._v(" "),t._m(2),a("p",[t._v("下载 elasticsearch ；")]),t._v(" "),t._m(3),a("p",[t._v("安装 elasticsearch ；")]),t._v(" "),t._m(4),a("p",[t._v("安装完成后编辑配置项")]),t._v(" "),t._m(5),a("p",[t._v("去掉下面三行的注释；")]),t._v(" "),t._m(6),t._m(7),t._v(" "),a("p",[t._v("启动 elasticsearch ；")]),t._v(" "),t._m(8),t._m(9),t._v(" "),a("p",[t._v("然后查看 9200 端口检查是否成功启动；")]),t._v(" "),t._m(10),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._m(14),t._v(" "),t._m(15),a("p",[t._v("查看状态是否正常；")]),t._v(" "),t._m(16),t._m(17),t._v(" "),a("p",[t._v("至此 elasticsearch 算是安装完成了；"),a("br"),t._v("\n但是如果想用来搜索中文；"),a("br"),t._v("\n还需要安装中文分词；"),a("br"),t._v("\n怎么算分词呢？"),a("br"),t._v(" "),a("a",{attrs:{href:"https://baijunyao.com/article/153",target:"_blank",rel:"noopener noreferrer"}},[t._v("全文搜索和中文分词"),a("OutboundLink")],1),t._v(" 文章中已经简单介绍过了；"),a("br"),t._v("\n这里我们从 elasticsearch 实战一遍；"),a("br"),t._v("\n比如说 "),a("code",[t._v("白俊遥技术博客")]),t._v(" 这句话；"),a("br"),t._v("\nelasticsearch内置的分词器对中文相当不友好；"),a("br"),t._v("\n只会一个只一个字的分；")]),t._v(" "),t._m(18),t._m(19),t._v(" "),t._m(20),t._v(" "),a("p",[t._v("安装 ik-analyzer ；")]),t._v(" "),t._m(21),a("p",[t._v("如果报下面这种错误的话可能是网络不好；")]),t._v(" "),t._m(22),t._m(23),t._v(" "),a("p",[t._v("然后重新启动下服务；")]),t._v(" "),t._m(24),a("p",[t._v("看下 ik-analyzer 的效果；")]),t._v(" "),t._m(25),t._m(26),t._v(" "),t._m(27),t._v(" "),t._m(28),t._m(29),t._v(" "),t._m(30),a("p",[t._v("重新启动下服务；")]),t._v(" "),t._m(31),a("p",[t._v("再看下分词效果 ；")]),t._v(" "),t._m(32),t._m(33),t._v(" "),t._m(34),t._v(" "),t._m(35),a("p",[t._v("生成索引；")]),t._v(" "),t._m(36)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[this._v("wget")]),this._v(" --no-cookies --no-check-certificate --header "),s("span",{pre:!0,attrs:{class:"token string"}},[this._v('"Cookie: gpw_e24=http:%2F%2Fwww.oracle.com%2F; oraclelicense=accept-securebackup-cookie"')]),this._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[this._v('"http://download.oracle.com/otn-pub/java/jdk/10.0.1+10/fb4372174a714e6b8c52526dc134031e/jdk-10.0.1_linux-x64_bin.rpm"')]),this._v("  \n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" rpm -ivh jdk-10.0.1_linux-x64_bin.rpm  \n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("java -version  \n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[this._v("wget")]),this._v(" https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.2.4.rpm  \n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" rpm -ivh elasticsearch-6.2.4.rpm  \n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("vim /etc/elasticsearch/elasticsearch.yml  \n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("bootstrap.memory_lock: "),s("span",{pre:!0,attrs:{class:"token boolean"}},[this._v("true")]),this._v("  \nnetwork.host: 192.168.0.1  \nhttp.port: 9200  \n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("然后把 network.host 改成 "),s("code",[this._v("localhost")]),s("br"),this._v(" "),s("img",{attrs:{src:"/uploads/article/20180603/5b13f885156ea.jpg",alt:""}})])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl daemon-reload  \n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("enable")]),t._v(" elasticsearch.service  \n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl start elasticsearch  \n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("稍等片刻给 elasticsearch 个启动的时间；"),s("br"),this._v("\n因为 elasticsearch 启动的略慢；"),s("br"),this._v("\n后续涉及到重启 elasticsearch 的时候也都记得稍等片刻；")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[this._v("netstat")]),this._v(" -plntu  \n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"/uploads/article/20180603/5b13f88f7ea53.jpg",alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("如果半天过后仍然没有启动起来；"),s("br"),this._v("\n可能是内存不够出错；")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("vim /etc/elasticsearch/jvm.options  \n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("把内存改为自己服务器内存的一半以下；"),s("br"),this._v("\n比如说这里改为 512M ；"),s("br"),this._v(" "),s("img",{attrs:{src:"/uploads/article/20180606/5b17771055b51.jpg",alt:""}}),s("br"),this._v("\n尝试启动；")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" systemctl restart elasticsearch  \n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[this._v("curl")]),this._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[this._v("'localhost:9200'")]),this._v("  \n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"/uploads/article/20180603/5b13f89b8e846.jpg",alt:""}})])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -H "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v("  -XGET "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost:9200/_analyze?pretty'")]),t._v(" -d "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"text":"白俊遥技术博客"}\'')]),t._v("  \n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"/uploads/article/20180603/5b13f8b4333cf.jpg",alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("所以我们需要一个中文分词器；"),s("br"),this._v("\n这里选择和 elasticsearch 配套的 ik-analyzer ；")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("/usr/share/elasticsearch/bin/elasticsearch-plugin "),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("install")]),this._v(" https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v6.2.4/elasticsearch-analysis-ik-6.2.4.zip  \n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("Exception "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" thread "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"main"')]),t._v(" java.net.ConnectException: Connection timed out "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Connection timed out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \nat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Native Method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("沐浴更衣大念帅白最帅；"),s("br"),this._v("\n再试几次即可；")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" systemctl restart elasticsearch  \n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -H "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v("  -XGET "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost:9200/_analyze?pretty'")]),t._v(" -d "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"analyzer":"ik_max_word","text":"白俊遥技术博客"}\'')]),t._v("  \n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"/uploads/article/20180603/5b13f8d104254.jpg",alt:""}}),s("br"),this._v("\n我们可以看到 技术 和 博客 两个词语已经成功组合到了一起；"),s("br"),this._v("\n然而本博主 白俊遥 的名字被硬生生的拆成了3个字这怎么忍；")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("还好强大的 analysis-ik 支持自定义词库；"),s("br"),this._v("\n增加自定义词库；")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("vim /etc/elasticsearch/analysis-ik/IKAnalyzer.cfg.xml  \n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"/uploads/article/20180603/5b13f8e5b6947.jpg",alt:""}}),s("br"),this._v("\n增加一个 白俊遥 到词库；")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[this._v("echo")]),this._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[this._v("'白俊遥'")]),this._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[this._v(">")]),this._v(" /etc/elasticsearch/analysis-ik/baijunyao.dic  \n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" systemctl restart elasticsearch  \n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -H "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v("  -XGET "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost:9200/_analyze?pretty'")]),t._v(" -d "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"analyzer":"ik_max_word","text":"白俊遥技术博客"}\'')]),t._v("  \n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"/uploads/article/20180603/5b13f8fe670c5.jpg",alt:""}}),s("br"),this._v("\n双击 666 ；")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("回到项目增加配置项；"),s("br"),this._v("\n/.env ;")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("SCOUT_DRIVER"),s("span",{pre:!0,attrs:{class:"token operator"}},[this._v("=")]),this._v("elasticsearch\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("php artisan elasticsearch:import "),s("span",{pre:!0,attrs:{class:"token string"}},[this._v('"App\\Models\\Article"')]),this._v("\n")])])])}],!1,null,null,null);r.options.__file="Elasticsearch.md";s.default=r.exports}}]);